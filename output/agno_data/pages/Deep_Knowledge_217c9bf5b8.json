{
  "title": "Deep Knowledge",
  "content": "Source: https://docs.agno.com/examples/use-cases/agents/deep_knowledge\n\nThis agent performs iterative searches through its knowledge base, breaking down complex\nqueries into sub-questions, and synthesizing comprehensive answers. It's designed to explore\ntopics deeply and thoroughly by following chains of reasoning.\n\nIn this example, the agent uses the Agno documentation as a knowledge base\n\n* Iteratively searches a knowledge base\n* Source attribution and citations\n\n```python cookbook/examples/agents/deep_knowledge.py theme={null}\nfrom textwrap import dedent\nfrom typing import List, Optional\n\nimport inquirer\nimport typer\nfrom agno.agent import Agent\nfrom agno.db.base import SessionType\nfrom agno.db.sqlite import SqliteDb\nfrom agno.knowledge.embedder.openai import OpenAIEmbedder\nfrom agno.knowledge.knowledge import Knowledge\nfrom agno.models.openai import OpenAIChat\nfrom agno.vectordb.lancedb import LanceDb, SearchType\nfrom rich import print\n\ndef initialize_knowledge_base():\n    \"\"\"Initialize the knowledge base with your preferred documentation or knowledge source\n    Here we use Agno docs as an example, but you can replace with any relevant URLs\n    \"\"\"\n    agent_knowledge = Knowledge(\n        vector_db=LanceDb(\n            uri=\"tmp/lancedb\",\n            table_name=\"deep_knowledge_knowledge\",\n            search_type=SearchType.hybrid,\n            embedder=OpenAIEmbedder(id=\"text-embedding-3-small\"),\n        ),\n    )\n    agent_knowledge.add_content(\n        url=\"https://docs.agno.com/llms-full.txt\",\n    )\n    return agent_knowledge\n\ndef get_agent_db():\n    \"\"\"Return agent storage\"\"\"\n    return SqliteDb(session_table=\"deep_knowledge_sessions\", db_file=\"tmp/agents.db\")\n\ndef create_agent(session_id: Optional[str] = None) -> Agent:\n    \"\"\"Create and return a configured DeepKnowledge agent.\"\"\"\n    agent_knowledge = initialize_knowledge_base()\n    agent_db = get_agent_db()\n    return Agent(\n        name=\"DeepKnowledge\",\n        session_id=session_id,\n        model=OpenAIChat(id=\"gpt-5-mini\"),\n        description=dedent(\"\"\"\\\n        You are DeepKnowledge, an advanced reasoning agent designed to provide thorough,\n        well-researched answers to any query by searching your knowledge base.\n\nYour strengths include:\n        - Breaking down complex topics into manageable components\n        - Connecting information across multiple domains\n        - Providing nuanced, well-researched answers\n        - Maintaining intellectual honesty and citing sources\n        - Explaining complex concepts in clear, accessible terms\"\"\"),\n        instructions=dedent(\"\"\"\\\n        Your mission is to leave no stone unturned in your pursuit of the correct answer.\n\nTo achieve this, follow these steps:\n        1. **Analyze the input and break it down into key components**.\n        2. **Search terms**: You must identify at least 3-5 key search terms to search for.\n        3. **Initial Search:** Searching your knowledge base for relevant information. You must make atleast 3 searches to get all relevant information.\n        4. **Evaluation:** If the answer from the knowledge base is incomplete, ambiguous, or insufficient - Ask the user for clarification. Do not make informed guesses.\n        5. **Iterative Process:**\n            - Continue searching your knowledge base till you have a comprehensive answer.\n            - Reevaluate the completeness of your answer after each search iteration.\n            - Repeat the search process until you are confident that every aspect of the question is addressed.\n        4. **Reasoning Documentation:** Clearly document your reasoning process:\n            - Note when additional searches were triggered.\n            - Indicate which pieces of information came from the knowledge base and where it was sourced from.\n            - Explain how you reconciled any conflicting or ambiguous information.\n        5. **Final Synthesis:** Only finalize and present your answer once you have verified it through multiple search passes.\n            Include all pertinent details and provide proper references.\n        6. **Continuous Improvement:** If new, relevant information emerges even after presenting your answer,\n            be prepared to update or expand upon your response.\n\n**Communication Style:**\n        - Use clear and concise language.\n        - Organize your response with numbered steps, bullet points, or short paragraphs as needed.\n        - Be transparent about your search process and cite your sources.\n        - Ensure that your final answer is comprehensive and leaves no part of the query unaddressed.\n\nRemember: **Do not finalize your answer until every angle of the question has been explored.**\"\"\"),\n        additional_context=dedent(\"\"\"\\\n        You should only respond with the final answer and the reasoning process.\n        No need to include irrelevant information.\n\n- User ID: {user_id}\n        - Memory: You have access to your previous search results and reasoning process.\n        \"\"\"),\n        knowledge=agent_knowledge,\n        db=agent_db,\n        add_history_to_context=True,\n        num_history_runs=3,\n        read_chat_history=True,\n        markdown=True,\n    )\n\ndef get_example_topics() -> List[str]:\n    \"\"\"Return a list of example topics for the agent.\"\"\"\n    return [\n        \"What are AI agents and how do they work in Agno?\",\n        \"What chunking strategies does Agno support for text processing?\",\n        \"How can I implement custom tools in Agno?\",\n        \"How does knowledge retrieval work in Agno?\",\n        \"What types of embeddings does Agno support?\",\n    ]\n\ndef handle_session_selection() -> Optional[str]:\n    \"\"\"Handle session selection and return the selected session ID.\"\"\"\n    agent_db = get_agent_db()\n\nnew = typer.confirm(\"Do you want to start a new session?\", default=True)\n    if new:\n        return None\n\nexisting_sessions: List[str] = agent_db.get_sessions(session_type=SessionType.AGENT)\n    if not existing_sessions:\n        print(\"No existing sessions found. Starting a new session.\")\n        return None\n\nprint(\"\\nExisting sessions:\")\n    for i, session in enumerate(existing_sessions, 1):\n        print(f\"{i}. {session}\")\n\nsession_idx = typer.prompt(\n        \"Choose a session number to continue (or press Enter for most recent)\",\n        default=1,\n    )\n\ntry:\n        return existing_sessions[int(session_idx) - 1]\n    except (ValueError, IndexError):\n        return existing_sessions[0]\n\ndef run_interactive_loop(agent: Agent):\n    \"\"\"Run the interactive question-answering loop.\"\"\"\n    example_topics = get_example_topics()\n\nwhile True:\n        choices = [f\"{i + 1}. {topic}\" for i, topic in enumerate(example_topics)]\n        choices.extend([\"Enter custom question...\", \"Exit\"])\n\nquestions = [\n            inquirer.List(\n                \"topic\",\n                message=\"Select a topic or ask a different question:\",\n                choices=choices,\n            )\n        ]\n        answer = inquirer.prompt(questions)\n\nif answer[\"topic\"] == \"Exit\":\n            break\n\nif answer[\"topic\"] == \"Enter custom question...\":\n            questions = [inquirer.Text(\"custom\", message=\"Enter your question:\")]\n            custom_answer = inquirer.prompt(questions)\n            topic = custom_answer[\"custom\"]\n        else:\n            topic = example_topics[int(answer[\"topic\"].split(\".\")[0]) - 1]\n\nagent.print_response(topic, stream=True)\n\ndef deep_knowledge_agent():\n    \"\"\"Main function to run the DeepKnowledge agent.\"\"\"\n\nsession_id = handle_session_selection()\n    agent = create_agent(session_id)\n\nprint(\"\\nðŸ¤” Welcome to DeepKnowledge - Your Advanced Research Assistant! ðŸ“š\")\n    if session_id is None:\n        session_id = agent.session_id\n        if session_id is not None:\n            print(f\"[bold green]Started New Session: {session_id}[/bold green]\\n\")\n        else:\n            print(\"[bold green]Started New Session[/bold green]\\n\")\n    else:\n        print(f\"[bold blue]Continuing Previous Session: {session_id}[/bold blue]\\n\")\n\nrun_interactive_loop(agent)\n\nif __name__ == \"__main__\":\n    typer.run(deep_knowledge_agent)",
  "code_samples": [],
  "headings": [
    {
      "level": "h2",
      "text": "Code",
      "id": "code"
    }
  ],
  "url": "llms-txt#deep-knowledge",
  "links": []
}
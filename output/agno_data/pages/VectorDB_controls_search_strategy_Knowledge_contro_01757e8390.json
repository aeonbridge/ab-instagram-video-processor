{
  "title": "VectorDB controls search strategy; Knowledge controls retrieval size",
  "content": "vector_db = PgVector(table_name=\"embeddings_table\", db_url=db_url, search_type=SearchType.hybrid)\nknowledge = Knowledge(vector_db=vector_db, max_results=5)\npython  theme={null}\nknowledge.add_content(\n    path=\"policies/\",\n    metadata={\"type\": \"policy\", \"department\": \"HR\", \"audience\": \"employees\"},\n)\npython  theme={null}\n\"hr_employee_handbook_2024.pdf\"  # ✅ Clear and descriptive\n\"document1.pdf\"                  # ❌ Generic and unhelpful\npython  theme={null}\ntest_queries = [\n    \"What's our vacation policy?\",\n    \"How do I submit expenses?\",\n    \"Remote work guidelines\",\n]\n\nfor q in test_queries:\n    results = knowledge.search(q)\n    print(q, \"->\", results[0].content[:100] + \"...\" if results else \"No results\")\npython  theme={null}\nasync def my_retriever(query: str, num_documents: int = 5, filters: dict | None = None, **kwargs):\n    # Example: reformulate query, then search with metadata filters\n    refined = query.replace(\"vacation\", \"paid time off\")\n    docs = await knowledge.async_search(refined, max_results=num_documents, filters=filters)\n    return [d.to_dict() for d in docs]\n\nagent.knowledge_retriever = my_retriever\npython  theme={null}",
  "code_samples": [
    {
      "code": "## Making Search Work Better\n\n### Add Rich Metadata\n\nMetadata helps filter and organize results:",
      "language": "unknown"
    },
    {
      "code": "### Use Descriptive Filenames\n\nFile names can help with search relevance in some backends:",
      "language": "unknown"
    },
    {
      "code": "### Structure Content Logically\n\nWell-organized content searches better:\n\n* Use clear headings and sections\n* Include relevant terminology naturally (don't keyword-stuff)\n* Add summaries at the top of long documents\n* Cross-reference related topics\n\n### Test with Real Queries\n\nThe best way to know if search is working? Try it with actual questions:",
      "language": "unknown"
    },
    {
      "code": "### Analyze What's Being Retrieved\n\nAsk yourself:\n\n* Are results actually relevant to the query?\n* Is important information missing from results?\n* Are results in a sensible order? (If not, try adding a reranker)\n* Should you adjust chunk sizes or metadata?\n\n## Advanced Search Features\n\n### Custom Retrieval Logic for Agents\n\nProvide a `knowledge_retriever` callable to implement your own decisioning (e.g., reformulation, follow-up searches, domain rules). The agent will call this when fetching documents.",
      "language": "unknown"
    },
    {
      "code": "### Search with Filtering\n\nWhen agents search through knowledge bases, sometimes you need more control than just \"find similar content.\" Maybe you want to search only within specific documents, exclude outdated information, or focus on content from particular sources. That's where filtering comes in—it lets you precisely target which content gets retrieved.\n\nThink of filtering like adding smart constraints to a library search. Instead of searching through every book, you can tell the librarian: \"Only look in the science section, published after 2020, but exclude textbooks.\" Knowledge filtering works the same way—you specify criteria based on the metadata attached to your content.\n\n<Steps>\n  <Step title=\"Metadata Assignment\">\n    When you add content, attach metadata like department, document type, date, or any custom attributes.\n  </Step>\n\n  <Step title=\"Filter Construction\">\n    Build filters using dictionary format or filter expressions to define your search criteria.\n  </Step>\n\n  <Step title=\"Targeted Search\">\n    The knowledge base only searches through content that matches your filter conditions.\n  </Step>\n\n  <Step title=\"Contextual Results\">\n    You get precisely the information you need from exactly the right sources.\n  </Step>\n</Steps>\n\n#### Basic Dictionary Filters\n\nThe simplest way to filter is using dictionary format. All conditions are combined with AND logic:",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Making Search Work Better",
      "id": "making-search-work-better"
    },
    {
      "level": "h3",
      "text": "Add Rich Metadata",
      "id": "add-rich-metadata"
    },
    {
      "level": "h3",
      "text": "Use Descriptive Filenames",
      "id": "use-descriptive-filenames"
    },
    {
      "level": "h3",
      "text": "Structure Content Logically",
      "id": "structure-content-logically"
    },
    {
      "level": "h3",
      "text": "Test with Real Queries",
      "id": "test-with-real-queries"
    },
    {
      "level": "h3",
      "text": "Analyze What's Being Retrieved",
      "id": "analyze-what's-being-retrieved"
    },
    {
      "level": "h2",
      "text": "Advanced Search Features",
      "id": "advanced-search-features"
    },
    {
      "level": "h3",
      "text": "Custom Retrieval Logic for Agents",
      "id": "custom-retrieval-logic-for-agents"
    },
    {
      "level": "h3",
      "text": "Search with Filtering",
      "id": "search-with-filtering"
    }
  ],
  "url": "llms-txt#vectordb-controls-search-strategy;-knowledge-controls-retrieval-size",
  "links": []
}
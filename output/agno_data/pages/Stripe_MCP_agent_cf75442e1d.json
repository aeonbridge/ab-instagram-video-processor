{
  "title": "Stripe MCP agent",
  "content": "Source: https://docs.agno.com/basics/tools/mcp/usage/stripe\n\nUsing the [Stripe MCP server](https://github.com/stripe/agent-toolkit/tree/main/modelcontextprotocol) to create an Agent that can interact with the Stripe API:\n\n```python  theme={null}\n\"\"\"ðŸ’µ Stripe MCP Agent - Manage Your Stripe Operations\n\nThis example demonstrates how to create an Agno agent that interacts with the Stripe API via the Model Context Protocol (MCP). This agent can create and manage Stripe objects like customers, products, prices, and payment links using natural language commands.\n\nSetup:\n2. Install Python dependencies: `pip install agno mcp-sdk`\n3. Set Environment Variable: export STRIPE_SECRET_KEY=***.\n\nStripe MCP Docs: https://github.com/stripe/agent-toolkit\n\"\"\"\n\nimport asyncio\nimport os\nfrom textwrap import dedent\n\nfrom agno.agent import Agent\nfrom agno.tools.mcp import MCPTools\nfrom agno.utils.log import log_error, log_exception, log_info\n\nasync def run_agent(message: str) -> None:\n    \"\"\"\n    Sets up the Stripe MCP server and initialize the Agno agent\n    \"\"\"\n    # Verify Stripe API Key is available\n    stripe_api_key = os.getenv(\"STRIPE_SECRET_KEY\")\n    if not stripe_api_key:\n        log_error(\"STRIPE_SECRET_KEY environment variable not set.\")\n        return\n\nenabled_tools = \"paymentLinks.create,products.create,prices.create,customers.create,customers.read\"\n\n# handle different Operating Systems\n    npx_command = \"npx.cmd\" if os.name == \"nt\" else \"npx\"\n\ntry:\n        # Initialize MCP toolkit with Stripe server\n        async with MCPTools(\n            command=f\"{npx_command} -y @stripe/mcp --tools={enabled_tools} --api-key={stripe_api_key}\"\n        ) as mcp_toolkit:\n            agent = Agent(\n                name=\"StripeAgent\",\n                instructions=dedent(\"\"\"\\\n                    You are an AI assistant specialized in managing Stripe operations.\n                    You interact with the Stripe API using the available tools.\n\n- Understand user requests to create or list Stripe objects (customers, products, prices, payment links).\n                    - Clearly state the results of your actions, including IDs of created objects or lists retrieved.\n                    - Ask for clarification if a request is ambiguous.\n                    - Use markdown formatting, especially for links or code snippets.\n                    - Execute the necessary steps sequentially if a request involves multiple actions (e.g., create product, then price, then link).\n                \"\"\"),\n                tools=[mcp_toolkit],\n                markdown=True,\n                            )\n\n# Run the agent with the provided task\n            log_info(f\"Running agent with assignment: '{message}'\")\n            await agent.aprint_response(message, stream=True)\n\nexcept FileNotFoundError:\n        error_msg = f\"Error: '{npx_command}' command not found. Please ensure Node.js and npm/npx are installed and in your system's PATH.\"\n        log_error(error_msg)\n    except Exception as e:\n        log_exception(f\"An unexpected error occurred during agent execution: {e}\")\n\nif __name__ == \"__main__\":\n    task = \"Create a new Stripe product named 'iPhone'. Then create a price of $999.99 USD for it. Finally, create a payment link for that price.\"\n    asyncio.run(run_agent(task))",
  "code_samples": [],
  "headings": [],
  "url": "llms-txt#stripe-mcp-agent",
  "links": []
}
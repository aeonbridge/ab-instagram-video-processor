{
  "title": "Define the vector search index",
  "content": "search_index = SearchIndex(\n    name=\"vector_search\",\n    source_type=\"gocbcore\",\n    idx_type=\"fulltext-index\",\n    source_name=\"recipe_bucket\",\n    plan_params={\"index_partitions\": 1, \"num_replicas\": 0},\n    params={\n        \"doc_config\": {\n            \"docid_prefix_delim\": \"\",\n            \"docid_regexp\": \"\",\n            \"mode\": \"scope.collection.type_field\",\n            \"type_field\": \"type\",\n        },\n        \"mapping\": {\n            \"default_analyzer\": \"standard\",\n            \"default_datetime_parser\": \"dateTimeOptional\",\n            \"index_dynamic\": True,\n            \"store_dynamic\": True,\n            \"default_mapping\": {\"dynamic\": True, \"enabled\": False},\n            \"types\": {\n                \"recipe_scope.recipes\": {\n                    \"dynamic\": False,\n                    \"enabled\": True,\n                    \"properties\": {\n                        \"content\": {\n                            \"enabled\": True,\n                            \"fields\": [\n                                {\n                                    \"docvalues\": True,\n                                    \"include_in_all\": False,\n                                    \"include_term_vectors\": False,\n                                    \"index\": True,\n                                    \"name\": \"content\",\n                                    \"store\": True,\n                                    \"type\": \"text\",\n                                }\n                            ],\n                        },\n                        \"embedding\": {\n                            \"enabled\": True,\n                            \"dynamic\": False,\n                            \"fields\": [\n                                {\n                                    \"vector_index_optimized_for\": \"recall\",\n                                    \"docvalues\": True,\n                                    \"dims\": 1536,\n                                    \"include_in_all\": False,\n                                    \"include_term_vectors\": False,\n                                    \"index\": True,\n                                    \"name\": \"embedding\",\n                                    \"similarity\": \"dot_product\",\n                                    \"store\": True,\n                                    \"type\": \"vector\",\n                                }\n                            ],\n                        },\n                        \"meta\": {\n                            \"dynamic\": True,\n                            \"enabled\": True,\n                            \"properties\": {\n                                \"name\": {\n                                    \"enabled\": True,\n                                    \"fields\": [\n                                        {\n                                            \"docvalues\": True,\n                                            \"include_in_all\": False,\n                                            \"include_term_vectors\": False,\n                                            \"index\": True,\n                                            \"name\": \"name\",\n                                            \"store\": True,\n                                            \"analyzer\": \"keyword\",\n                                            \"type\": \"text\",\n                                        }\n                                    ],\n                                }\n                            },\n                        },\n                    },\n                }\n            },\n        },\n    },\n)\nvector_db = CouchbaseSearch(\n    bucket_name=\"recipe_bucket\",\n    scope_name=\"recipe_scope\",\n    collection_name=\"recipes\",\n    couchbase_connection_string=connection_string,\n    cluster_options=cluster_options,\n    search_index=search_index,\n    embedder=OpenAIEmbedder(\n        dimensions=1536,\n    ),\n    wait_until_index_ready=60,\n    overwrite=True,\n)\n\nknowledge = Knowledge(\n    name=\"Couchbase Knowledge Base\",\n    description=\"This is a knowledge base that uses a Couchbase DB\",\n    vector_db=vector_db,\n)\n\nknowledge.add_content(\n    name=\"Recipes\",\n    url=\"https://agno-public.s3.amazonaws.com/recipes/ThaiRecipes.pdf\",\n    metadata={\"doc_type\": \"recipe_book\"},\n)\nagent = Agent(\n    knowledge=knowledge,\n    search_knowledge=True,\n    read_chat_history=True,\n)\n\nagent.print_response(\"List down the ingredients to make Massaman Gai\", markdown=True)\n\nvector_db.delete_by_name(\"Recipes\")",
  "code_samples": [],
  "headings": [],
  "url": "llms-txt#define-the-vector-search-index",
  "links": []
}
{
  "title": "Define agents for use in custom functions",
  "content": "hackernews_agent = Agent(\n    name=\"Hackernews Agent\",\n    model=OpenAIChat(id=\"gpt-4o\"),\n    tools=[HackerNewsTools()],\n    instructions=\"Extract key insights and content from Hackernews posts\",\n    db=InMemoryDb(),\n)\n\nweb_agent = Agent(\n    name=\"Web Agent\",\n    model=OpenAIChat(id=\"gpt-4o\"),\n    tools=[DuckDuckGoTools()],\n    instructions=\"Search the web for the latest news and trends\",\n    db=InMemoryDb(),\n)\n\ncontent_planner = Agent(\n    name=\"Content Planner\",\n    model=OpenAIChat(id=\"gpt-4o\"),\n    instructions=[\n        \"Plan a content schedule over 4 weeks for the provided topic and research content\",\n        \"Ensure that I have posts for 3 posts per week\",\n    ],\n    db=InMemoryDb(),\n)\n\nasync def hackernews_research_function(\n    step_input: StepInput,\n) -> AsyncIterator[Union[WorkflowRunOutputEvent, StepOutput]]:\n    \"\"\"\n    Custom function for HackerNews research with enhanced processing and streaming\n    \"\"\"\n    message = step_input.input\n\nresearch_prompt = f\"\"\"\n        HACKERNEWS RESEARCH REQUEST:\n\nResearch Tasks:\n        1. Search for relevant HackerNews posts and discussions\n        2. Extract key insights and trends\n        3. Identify popular opinions and debates\n        4. Summarize technical developments\n        5. Note community sentiment and engagement levels\n\nPlease provide comprehensive HackerNews research results.\n    \"\"\"\n\ntry:\n        # Stream the agent response\n        response_iterator = hackernews_agent.arun(\n            research_prompt, stream=True, stream_events=True\n        )\n        async for event in response_iterator:\n            yield event\n\n# Get the final response\n        response = hackernews_agent.get_last_run_output()\n\n# Check if response and content exist\n        response_content = \"\"\n        if response and hasattr(response, \"content\") and response.content:\n            response_content = response.content\n        else:\n            response_content = \"No content available from HackerNews research\"\n\nenhanced_content = f\"\"\"\n            ## HackerNews Research Results\n\n**Research Topic:** {message}\n            **Source:** HackerNews Community Analysis\n            **Processing:** Enhanced with custom streaming function\n\n**Findings:**\n            {response_content}\n\n**Custom Function Enhancements:**\n            - Community Focus: HackerNews developer perspectives\n            - Technical Depth: High-level technical discussions\n            - Trend Analysis: Developer sentiment and adoption patterns\n            - Streaming: Real-time research progress updates\n        \"\"\".strip()\n\nyield StepOutput(content=enhanced_content)\n\nexcept Exception as e:\n        yield StepOutput(\n            content=f\"HackerNews research failed: {str(e)}\",\n            success=False,\n        )\n\nasync def web_search_research_function(\n    step_input: StepInput,\n) -> AsyncIterator[Union[WorkflowRunOutputEvent, StepOutput]]:\n    \"\"\"\n    Custom function for web search research with enhanced processing and streaming\n    \"\"\"\n    message = step_input.input\n\nresearch_prompt = f\"\"\"\n        WEB SEARCH RESEARCH REQUEST:\n\nResearch Tasks:\n        1. Search for the latest news and articles\n        2. Identify market trends and business implications\n        3. Find expert opinions and analysis\n        4. Gather statistical data and reports\n        5. Note mainstream media coverage and public sentiment\n\nPlease provide comprehensive web research results.\n    \"\"\"\n\ntry:\n        # Stream the agent response\n        response_iterator = web_agent.arun(\n            research_prompt, stream=True, stream_events=True\n        )\n        async for event in response_iterator:\n            yield event\n\n# Get the final response\n        response = web_agent.get_last_run_output()\n\n# Check if response and content exist\n        response_content = \"\"\n        if response and hasattr(response, \"content\") and response.content:\n            response_content = response.content\n        else:\n            response_content = \"No content available from web search research\"\n\nenhanced_content = f\"\"\"\n            ## Web Search Research Results\n\n**Research Topic:** {message}\n            **Source:** General Web Search Analysis\n            **Processing:** Enhanced with custom streaming function\n\n**Findings:**\n            {response_content}\n\n**Custom Function Enhancements:**\n            - Market Focus: Business and mainstream perspectives\n            - Trend Analysis: Public adoption and market signals\n            - Data Integration: Statistical and analytical insights\n            - Streaming: Real-time research progress updates\n        \"\"\".strip()\n\nyield StepOutput(content=enhanced_content)\n\nexcept Exception as e:\n        yield StepOutput(\n            content=f\"Web search research failed: {str(e)}\",\n            success=False,\n        )\n\nasync def custom_content_planning_function(\n    step_input: StepInput,\n) -> AsyncIterator[Union[WorkflowRunOutputEvent, StepOutput]]:\n    \"\"\"\n    Custom function that does intelligent content planning with context awareness and streaming\n    \"\"\"\n    message = step_input.input\n    previous_step_content = step_input.previous_step_content\n\n# Create intelligent planning prompt\n    planning_prompt = f\"\"\"\n        STRATEGIC CONTENT PLANNING REQUEST:\n\nCore Topic: {message}\n\nResearch Results: {previous_step_content[:1000] if previous_step_content else \"No research results\"}\n\nPlanning Requirements:\n        1. Create a comprehensive content strategy based on the research\n        2. Leverage the research findings effectively\n        3. Identify content formats and channels\n        4. Provide timeline and priority recommendations\n        5. Include engagement and distribution strategies\n\nPlease create a detailed, actionable content plan.\n    \"\"\"\n\ntry:\n        # Stream the agent response\n        response_iterator = content_planner.arun(\n            planning_prompt, stream=True, stream_events=True\n        )\n        async for event in response_iterator:\n            yield event\n\n# Get the final response\n        response = content_planner.get_last_run_output()\n\n# Check if response and content exist\n        response_content = \"\"\n        if response and hasattr(response, \"content\") and response.content:\n            response_content = response.content\n        else:\n            response_content = \"No content available from content planning\"\n\nenhanced_content = f\"\"\"\n            ## Strategic Content Plan\n\n**Planning Topic:** {message}\n\n**Research Integration:** {\"✓ Multi-source research\" if previous_step_content else \"✗ No research foundation\"}\n\n**Content Strategy:**\n            {response_content}\n\n**Custom Planning Enhancements:**\n            - Research Integration: {\"High (Parallel sources)\" if previous_step_content else \"Baseline\"}\n            - Strategic Alignment: Optimized for multi-channel distribution\n            - Execution Ready: Detailed action items included\n            - Source Diversity: HackerNews + Web + Social insights\n            - Streaming: Real-time planning progress updates\n        \"\"\".strip()\n\nyield StepOutput(content=enhanced_content)\n\nexcept Exception as e:\n        yield StepOutput(\n            content=f\"Custom content planning failed: {str(e)}\",\n            success=False,\n        )",
  "code_samples": [],
  "headings": [],
  "url": "llms-txt#define-agents-for-use-in-custom-functions",
  "links": []
}
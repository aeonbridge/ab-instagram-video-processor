{
  "title": "Create steps with shared history",
  "content": "tech_support_step = Step(\n    name=\"Technical Support\",\n    agent=tech_support_agent,\n    add_workflow_history=True,\n)\n\nbilling_support_step = Step(\n    name=\"Billing Support\",\n    agent=billing_agent,\n    add_workflow_history=True,\n)\n\ngeneral_support_step = Step(\n    name=\"General Support\",\n    agent=general_support_agent,\n    add_workflow_history=True,\n)\n\ndef simple_intent_router(step_input: StepInput) -> List[Step]:\n    \"\"\"\n    Simple intent-based router with basic keyword detection.\n    The focus is on shared history, not complex routing logic.\n    \"\"\"\n    current_message = step_input.input or \"\"\n    current_message_lower = current_message.lower()\n\n# Simple keyword matching for intent detection\n    tech_keywords = [\n        \"api\",\n        \"error\",\n        \"bug\",\n        \"technical\",\n        \"login\",\n        \"not working\",\n        \"broken\",\n        \"crash\",\n    ]\n    billing_keywords = [\n        \"billing\",\n        \"payment\",\n        \"refund\",\n        \"charge\",\n        \"subscription\",\n        \"invoice\",\n        \"plan\",\n    ]\n\n# Simple routing logic\n    if any(keyword in current_message_lower for keyword in tech_keywords):\n        print(\"ðŸ”§ Routing to Technical Support\")\n        return [tech_support_step]\n    elif any(keyword in current_message_lower for keyword in billing_keywords):\n        print(\"ðŸ’³ Routing to Billing Support\")\n        return [billing_support_step]\n    else:\n        print(\"ðŸŽ§ Routing to General Support\")\n        return [general_support_step]\n\ndef create_smart_customer_service_workflow():\n    \"\"\"Customer service workflow with simple routing and shared history\"\"\"\n\nreturn Workflow(\n        name=\"Smart Customer Service\",\n        description=\"Simple routing to specialists with shared conversation history\",\n        db=SqliteDb(db_file=\"tmp/smart_customer_service.db\"),\n        steps=[\n            Router(\n                name=\"Customer Service Router\",\n                selector=simple_intent_router,\n                choices=[tech_support_step, billing_support_step, general_support_step],\n                description=\"Routes to appropriate specialist based on simple intent detection\",\n            )\n        ],\n        add_workflow_history_to_steps=True,  # Enable history for the workflow\n    )\n\ndef demo_smart_customer_service_cli():\n    \"\"\"Demo the smart customer service workflow with CLI\"\"\"\n    workflow = create_smart_customer_service_workflow()\n\nprint(\"ðŸŽ§ Smart Customer Service Demo\")\n    print(\"=\" * 60)\n    print(\"\")\n    print(\"This workflow demonstrates:\")\n    print(\"â€¢ ðŸ¤– Simple routing between Technical, Billing, and General support\")\n    print(\"â€¢ ðŸ“š Shared conversation history across ALL agents\")\n    print(\"â€¢ ðŸ’¬ Context continuity - agents remember your entire conversation\")\n    print(\"\")\n    print(\"ðŸŽ¯ TRY THESE CONVERSATIONS:\")\n    print(\"\")\n    print(\"ðŸ”§ TECHNICAL SUPPORT:\")\n    print(\"   â€¢ 'My API is not working'\")\n    print(\"   â€¢ 'I'm getting an error message'\")\n    print(\"   â€¢ 'There's a technical bug'\")\n    print(\"\")\n    print(\"ðŸ’³ BILLING SUPPORT:\")\n    print(\"   â€¢ 'I need help with billing'\")\n    print(\"   â€¢ 'Can I get a refund?'\")\n    print(\"   â€¢ 'My payment was charged twice'\")\n    print(\"\")\n    print(\"ðŸŽ§ GENERAL SUPPORT:\")\n    print(\"   â€¢ 'Hello, I have a question'\")\n    print(\"   â€¢ 'What features do you offer?'\")\n    print(\"   â€¢ 'I need general help'\")\n    print(\"\")\n    print(\"Type 'exit' to quit\")\n    print(\"-\" * 60)\n\nworkflow.cli_app(\n        session_id=\"smart_customer_service_demo\",\n        user=\"Customer\",\n        emoji=\"ðŸŽ§\",\n        stream=True,\n        show_step_details=True,\n    )\n\nif __name__ == \"__main__\":\n    demo_smart_customer_service_cli()\n```",
  "code_samples": [],
  "headings": [],
  "url": "llms-txt#create-steps-with-shared-history",
  "links": []
}